// ============================================
// KL'élite Product Card - Luxury Design
// Following claudekit-engineer: BEAUTIFUL + SATISFYING + PEAK
// Variables auto-injected via Vite
// ============================================

.card {
  position: relative;
  background: var(--card-bg);
  border-radius: $radius-xl;
  overflow: hidden;
  box-shadow: var(--card-shadow);
  transition:
    transform $transition-fast $ease-out,
    box-shadow $transition-fast $ease-out,
    background-color $duration-normal $ease-out;
  
  &:hover {
    transform: translateY(-8px);
    box-shadow: $shadow-xl;
    
    .image img {
      transform: scale(1.08);
    }
    
    .quickActions {
      opacity: 1;
      transform: translateY(0);
    }
    
    .overlay {
      opacity: 1;
    }
  }

  // Accessibility Focus Styles
  &:focus-within {
    .quickActions {
      opacity: 1;
      transform: translateY(0);
    }
  }
}

// ============================================
// Image Section
// ============================================
.imageWrapper {
  position: relative;
  aspect-ratio: 4 / 5;
  overflow: hidden;
  background: $cream;
}

.image {
  width: 100%;
  height: 100%;
  
  img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform $transition-normal $ease-out;
  }
}

.overlay {
  position: absolute;
  inset: 0;
  background: linear-gradient(
    180deg,
    transparent 40%,
    rgba($dark-primary, 0.4) 100%
  );
  opacity: 0;
  transition: opacity $transition-fast $ease-out;
  pointer-events: none;
}

// ============================================
// Badges
// ============================================
.badges {
  position: absolute;
  top: $spacing-sm;
  left: $spacing-sm;
  display: flex;
  flex-direction: column;
  gap: $spacing-2xs;
  z-index: 2;
}

.badge {
  padding: $spacing-2xs $spacing-sm;
  font-family: $font-body;
  font-size: $text-2xs;
  font-weight: $font-bold;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  border-radius: $radius-sm;
  
  &.new {
    background: $gradient-gold;
    color: $dark-primary;
    animation: badgeGlow 2s ease-in-out infinite;
  }
  
  &.sale {
    background: #e53935;
    color: white;
  }
  
  &.bestseller {
    background: $dark-primary;
    color: $gold-primary;
  }
  
  &.limited {
    background: linear-gradient(135deg, #9C27B0, #673AB7);
    color: white;
  }
}

@keyframes badgeGlow {
  0%, 100% {
    box-shadow: 0 2px 8px rgba($gold-primary, 0.4);
  }
  50% {
    box-shadow: 0 2px 16px rgba($gold-primary, 0.6);
  }
}

// ============================================
// Wishlist Button
// ============================================
.wishlistButton {
  position: absolute;
  top: $spacing-sm;
  right: $spacing-sm;
  width: 40px;
  height: 40px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: rgba(white, 0.9);
  backdrop-filter: blur(8px);
  border: none;
  border-radius: $radius-full;
  cursor: pointer;
  z-index: 2;
  transition: all $transition-micro $ease-out;
  
  svg {
    width: 20px;
    height: 20px;
    color: $text-secondary;
    transition: all $transition-micro $ease-out;
  }
  
  &:hover {
    background: white;
    transform: scale(1.1);
    box-shadow: $shadow-md;
    
    svg {
      color: #e53935;
    }
  }
  
  &:active {
    transform: scale(0.95);
  }
  
  &.active {
    svg {
      color: #e53935;
      fill: #e53935;
      animation: heartBeat 0.3s ease;
    }
  }
}

@keyframes heartBeat {
  0% { transform: scale(1); }
  25% { transform: scale(1.3); }
  50% { transform: scale(1); }
  75% { transform: scale(1.15); }
  100% { transform: scale(1); }
}

// ============================================
// Quick Actions (on hover)
// ============================================
.quickActions {
  position: absolute;
  bottom: $spacing-md;
  left: 50%;
  transform: translateX(-50%) translateY(20px);
  display: flex;
  gap: $spacing-xs;
  opacity: 0;
  transition: all $transition-fast $ease-out;
  z-index: 3;
}

.quickAction {
  width: 44px;
  height: 44px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: white;
  border: none;
  border-radius: $radius-full;
  cursor: pointer;
  box-shadow: $shadow-md;
  transition: all $transition-micro $ease-out;
  
  svg {
    width: 20px;
    height: 20px;
    color: $text-secondary;
    transition: color $transition-micro $ease-out;
  }
  
  &:hover {
    background: $gradient-gold;
    transform: scale(1.1);
    
    svg {
      color: $dark-primary;
    }
  }
  
  &:active {
    transform: scale(0.95);
  }
}

// ============================================
// Content Section
// ============================================
.content {
  padding: $spacing-md;
}

.category {
  font-family: $font-accent;
  font-size: $text-xs;
  font-weight: $font-medium;
  color: $gold-secondary;
  text-transform: uppercase;
  letter-spacing: 1px;
  margin-bottom: $spacing-2xs;
}

.name {
  font-family: $font-heading;
  font-size: $text-lg;
  font-weight: $font-semibold;
  color: $text-primary;
  margin-bottom: $spacing-xs;
  line-height: 1.3;
  
  // Truncate long names
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
  
  a {
    color: inherit;
    text-decoration: none;
    transition: color $transition-micro $ease-out;
    
    &:hover {
      color: $gold-primary;
    }
  }
}

.description {
  font-family: $font-body;
  font-size: $text-sm;
  color: $text-muted;
  line-height: 1.5;
  margin-bottom: $spacing-sm;
  
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

// ============================================
// Rating
// ============================================
.rating {
  display: flex;
  align-items: center;
  gap: $spacing-xs;
  margin-bottom: $spacing-sm;
}

.stars {
  display: flex;
  gap: 2px;
  
  svg {
    width: 16px;
    height: 16px;
    color: #e0e0e0;
    
    &.filled {
      color: #ffc107;
      fill: #ffc107;
    }
    
    &.half {
      color: #ffc107;
      // Half star effect handled via clip-path or overlay
    }
  }
}

.ratingCount {
  font-size: $text-xs;
  color: $text-muted;
}

// ============================================
// Price Section
// ============================================
.priceSection {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: $spacing-sm;
}

.prices {
  display: flex;
  align-items: baseline;
  gap: $spacing-xs;
}

.currentPrice {
  font-family: $font-heading;
  font-size: $text-xl;
  font-weight: $font-bold;
  color: $gold-primary;
}

.originalPrice {
  font-family: $font-body;
  font-size: $text-sm;
  color: $text-muted;
  text-decoration: line-through;
}

.discount {
  font-size: $text-xs;
  font-weight: $font-semibold;
  color: #e53935;
  background: rgba(#e53935, 0.1);
  padding: 2px 6px;
  border-radius: $radius-sm;
}

// ============================================
// Add to Cart Button
// ============================================
.addToCartButton {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: $spacing-xs;
  padding: $spacing-sm $spacing-md;
  background: $gradient-gold;
  color: $dark-primary;
  font-family: $font-body;
  font-size: $text-sm;
  font-weight: $font-semibold;
  border: none;
  border-radius: $radius-md;
  cursor: pointer;
  transition: all $transition-micro $ease-out;
  white-space: nowrap;
  
  svg {
    width: 18px;
    height: 18px;
    transition: transform $transition-micro $ease-out;
  }
  
  &:hover {
    box-shadow: $shadow-gold;
    transform: scale(1.05);
    
    svg {
      transform: scale(1.15);
    }
  }
  
  &:active {
    transform: scale(0.98);
  }
  
  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
    transform: none;
  }
  
  // Icon only on small cards
  &.iconOnly {
    padding: $spacing-sm;
    border-radius: $radius-full;
    
    span {
      display: none;
    }
  }
}

// ============================================
// Card Size Variants
// ============================================
.cardSmall {
  .imageWrapper {
    aspect-ratio: 1;
  }
  
  .content {
    padding: $spacing-sm;
  }
  
  .name {
    font-size: $text-base;
  }
  
  .description {
    display: none;
  }
  
  .currentPrice {
    font-size: $text-lg;
  }
}

.cardLarge {
  .imageWrapper {
    aspect-ratio: 3 / 4;
  }
  
  .content {
    padding: $spacing-lg;
  }
  
  .name {
    font-size: $text-xl;
  }
  
  .currentPrice {
    font-size: $text-2xl;
  }
}

// ============================================
// Horizontal Card Variant
// ============================================
.cardHorizontal {
  display: flex;
  
  .imageWrapper {
    width: 140px;
    flex-shrink: 0;
    aspect-ratio: auto;
    height: 100%;
    min-height: 160px;
  }
  
  .content {
    flex: 1;
    display: flex;
    flex-direction: column;
    justify-content: center;
  }
  
  .quickActions {
    flex-direction: column;
    right: $spacing-sm;
    left: auto;
    bottom: 50%;
    transform: translateY(50%) translateX(20px);
  }
  
  &:hover .quickActions {
    transform: translateY(50%) translateX(0);
  }
}

// ============================================
// Skeleton Loading State (with Dark Mode Support)
// ============================================
.skeleton {
  .imageWrapper {
    position: relative;
    overflow: hidden;
    background: var(--skeleton-bg, #{$background-muted});

    &::after {
      content: '';
      position: absolute;
      inset: 0;
      transform: translateX(-100%);
      background: linear-gradient(
        90deg,
        transparent 0%,
        var(--skeleton-shimmer, rgba(255, 255, 255, 0.4)) 50%,
        transparent 100%
      );
      animation: shimmerMove 1.5s ease-in-out infinite;
    }
  }

  .skeletonText {
    height: 1em;
    position: relative;
    overflow: hidden;
    background: var(--skeleton-bg, #{$background-muted});
    border-radius: $radius-sm;

    &::after {
      content: '';
      position: absolute;
      inset: 0;
      transform: translateX(-100%);
      background: linear-gradient(
        90deg,
        transparent 0%,
        var(--skeleton-shimmer, rgba(255, 255, 255, 0.4)) 50%,
        transparent 100%
      );
      animation: shimmerMove 1.5s ease-in-out infinite;
    }

    &.short {
      width: 40%;
    }

    &.medium {
      width: 70%;
    }

    &.long {
      width: 100%;
    }
  }
}

@keyframes shimmerMove {
  0% {
    transform: translateX(-100%);
  }
  100% {
    transform: translateX(100%);
  }
}

// Skeleton CSS variables
:root {
  --skeleton-bg: #{$gray-200};
  --skeleton-shimmer: rgba(255, 255, 255, 0.5);
}

[data-theme="dark"] {
  --skeleton-bg: #{rgba($gray-600, 0.3)};
  --skeleton-shimmer: rgba(255, 255, 255, 0.1);
}

// ============================================
// Out of Stock State
// ============================================
.outOfStock {
  .imageWrapper::after {
    content: 'Hết hàng';
    position: absolute;
    inset: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    background: rgba($dark-primary, 0.7);
    color: white;
    font-family: $font-heading;
    font-size: $text-lg;
    font-weight: $font-semibold;
    text-transform: uppercase;
    letter-spacing: 2px;
  }
  
  .addToCartButton {
    background: $text-muted;
    cursor: not-allowed;
    
    &:hover {
      transform: none;
      box-shadow: none;
    }
  }
}

// ============================================
// Featured/Highlighted Card
// ============================================
.featured {
  border: 2px solid $gold-primary;
  
  &::before {
    content: '';
    position: absolute;
    inset: -2px;
    border-radius: $radius-xl;
    padding: 2px;
    background: $gradient-gold;
    -webkit-mask: 
      linear-gradient(#fff 0 0) content-box, 
      linear-gradient(#fff 0 0);
    mask: 
      linear-gradient(#fff 0 0) content-box, 
      linear-gradient(#fff 0 0);
    -webkit-mask-composite: xor;
    mask-composite: exclude;
    animation: borderGlow 3s ease-in-out infinite;
  }
}

@keyframes borderGlow {
  0%, 100% {
    opacity: 0.5;
  }
  50% {
    opacity: 1;
  }
}
